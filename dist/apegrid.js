var e={d:(t,o)=>{for(var n in o)e.o(o,n)&&!e.o(t,n)&&Object.defineProperty(t,n,{enumerable:!0,get:o[n]})},o:(e,t)=>Object.prototype.hasOwnProperty.call(e,t)},t={};e.d(t,{v:()=>u,k:()=>h});let o=null,n=null;function i(e){if(!e||!e.element)return;const t=e.element;let o=!1;e.ignoreOut&&(o=!0),l(t),t.addEventListener("touchstart",(function(e){e.preventDefault(),e.stopPropagation()}),{passive:!1}),t.addEventListener("pointerdown",(function(o){o.preventDefault(),o.stopPropagation();let n="mouse";o.pointerType&&(n=o.pointerType);let i=1;o.pressure&&(i=o.pressure);let l=1;return"mouse"==n&&o.which&&(l=o.which),e.down&&e.down({element:t,id:o.pointerId,x:o.offsetX,y:o.offsetY,type:n,pressure:i,which:l,pageX:o.pageX,pageY:o.pageY}),!1}),{passive:!1}),t.addEventListener("pointermove",(function(o){o.preventDefault(),o.stopPropagation();let n="mouse";o.pointerType&&(n=o.pointerType);let i=1;o.pressure&&(i=o.pressure);let l=1;return"mouse"==n&&o.which&&(l=o.which),e.move&&e.move({element:t,id:o.pointerId,x:o.offsetX,y:o.offsetY,type:n,pressure:i,which:l,pageX:o.pageX,pageY:o.pageY}),!1}),{passive:!1}),o||t.addEventListener("pointerout",(function(o){o.preventDefault(),o.stopPropagation();let n="mouse";o.pointerType&&(n=o.pointerType);let i=1;return"mouse"==n&&o.which&&(i=o.which),e.up&&e.up({element:t,id:o.pointerId,type:n,which:i,evt:"out"}),!1}),{passive:!1}),t.addEventListener("pointerup",(function(o){o.preventDefault(),o.stopPropagation();let n="mouse";o.pointerType&&(n=o.pointerType);let i=1;return"mouse"==n&&o.which&&(i=o.which),e.up&&e.up({element:t,id:o.pointerId,type:n,which:i,evt:"up"}),!1}),{passive:!1})}function l(e){e.addEventListener("contextmenu",(function(e){return e.preventDefault(),e.stopPropagation(),!1}),{passive:!1}),e.addEventListener("ontouchforcechange",(function(e){return e.preventDefault(),e.stopPropagation(),!1}),{passive:!1}),e.addEventListener("webkitmouseforcewillbegin",(function(e){e.preventDefault(),e.stopPropagation()}),{passive:!1}),e.addEventListener("webkitmouseforcedown",(function(e){e.preventDefault(),e.stopPropagation()}),{passive:!1}),e.addEventListener("webkitmouseforceup",(function(e){e.preventDefault(),e.stopPropagation()}),{passive:!1}),e.addEventListener("webkitmouseforcechanged",(function(e){e.preventDefault(),e.stopPropagation()}),{passive:!1}),e.touchAction="none",e.contentZooming="none",e.msTouchAction="none",e.msContentZooming="none",e.style.touchAction="none",e.style.userSelect="none"}function s(){null!=n&&clearTimeout(n),o=null,n=null}window.apeApps||(window.apeApps={}),window.apeApps.utilities||(window.apeApps.utilities={}),window.apeApps.utilities.inputHelper={handleInput:function(e,t,o,n,l=!1){console.warn("apeApps.utilities.inputHelper.handleInput is deprecated. Please use module instead."),i({element:e,down:function(e){t(e.element,e.id,e.x,e.y,e.type,e.pressure,e.which,e.pageX,e.pageY)},move:function(e){o(e.element,e.id,e.x,e.y,e.type,e.pressure,e.which,e.pageX,e.pageY)},up:function(e){n(e.element,e.id,e.type,e.which,e.evt)},ignoreOut:l})},clearElementForTouch:l,clickAndContextHelper:function(e){if(!e||!e.element)return;const t=e.element;let i=!0;if(null!=e.vibrate&&(i=e.vibrate),/iPad|iPhone|iPod/.test(navigator.userAgent)){let l=null;t.ontouchstart=function(c){c.preventDefault(),c.stopPropagation(),l="down",o=t,n=setTimeout((function(){null!=o&&(o.touchStatus="up",i&&navigator.vibrate&&navigator.vibrate(100),e.context&&e.context({element:t,x:c.pageX,y:c.pageY})),s()}),600)},t.ontouchend=function(o){o.preventDefault(),o.stopPropagation();const n=l;if(l="up",s(),"down"==n){let n=t;o.target&&(n=o.target),e.click&&e.click({element:n,x:o.pageX,y:o.pageY})}},t.ontouchcancel=function(e){e.preventDefault(),e.stopPropagation(),l="up",s()},t.ontouchmove=function(e){e.preventDefault(),e.stopPropagation(),l="up",s()}}else t.onclick=function(o){o.preventDefault(),o.stopPropagation();let n=t;o.target&&(n=o.target),e.click&&e.click({element:n,x:o.pageX,y:o.pageY})},t.oncontextmenu=function(o){o.preventDefault(),o.stopPropagation(),i&&navigator.vibrate&&navigator.vibrate(50),e.context&&e.context({element:t,x:o.clientX,y:o.clientY})}}};const c=100,r={},a={},h={DEFAULT:0,TEXT:1,NUMBER:2,CURRENCY:3,PERCENT:4,DATE:5,TIME:6,DATE_TIME:7};class u{constructor(e,t={}){const o=this;o.holder=e,o.options=t||{},o.id=function(){function e(){return Math.floor(65536*(1+Math.random())).toString(16).substring(1)}return e()+e()+"-"+e()+"-"+e()+"-"+e()+"-"+e()+e()+e()}(),o.canvas=document.createElement("canvas"),o.canvas.style.imageRendering="pixelated",o.canvas.style.width="100%",o.canvas.style.height="100%",o.canvas.style.position="absolute",o.context=o.canvas.getContext("2d"),o.context.imageSmoothingEnabled=!1,o.holder.appendChild(o.canvas),o.needsDraw=!0,o.attached=!0,o.scale=1,o.width=1,o.height=1,o.totalColumns=24,o.totalRows=1e3,o.lastMouseScroll=0,o.manipulatingVBar=!1,o.manipulatingHBar=!1,o.vScrollShowing=!1,o.hScrollShowing=!1,o.currencyCode="USD",o.theme=t.theme||"#2196F3",o.gridlines=t.gridlines||!0,o.rowHeaders=t.rowHeaders||!0,o.colHeaders=t.colHeaders||!0,o.selMode=t.selMode||"default",o.defFont=t.defFont||"Arial",o.minRow=t.minRow||0,o.minCol=t.minCol||0,o.tag=t.tag||"worksheet tag",o.canResize=t.canResize||!0,o.origin={row:o.minRow,col:o.minCol},o.listeners={},o.colSizes={},o.rowSizes={},o.retainedValues={},o.isSelecting=!1,o.curSelection={start:null,end:null,tmp:null},o.resizePing=null,function(e){i({element:e.canvas,down:function(t){!function(e,t){if(!e.attached)return;const o=t.x,n=t.y;if(e.vScrollShowing&&o>e.width-8*e.scale)return e.manipulatingVBar=!0,void d(e,n);if(e.hScrollShowing&&n>e.height-8*e.scale)return e.manipulatingHBar=!0,void f(e,o);const i=p(e,o,n);if(i){if("-A"!=i.col&&i.row>-1){let t=i.col,o=i.col;"row"==e.selMode&&(t="A",o="Z"),e.curSelection.start={col:t,row:i.row},e.curSelection.tmp={col:o,row:i.row},e.curSelection.end=null,e.isSelecting=!0,e.needsDraw=!0}t.which&&3==t.which&&e.listeners.contextMenu&&e.listeners.contextMenu(i.col,i.row,t.pageX,t.pageY)}}(e,t)},move:function(t){!function(e,t){if(!e.attached)return;const o=t.x,n=t.y;if(e.manipulatingVBar)return void d(e,n);if(e.manipulatingHBar)return void f(e,o);const i=p(e,o,n);if(e.isSelecting&&e.curSelection.start&&"-A"!=i.col&&i.row>-1){let t=i.col,o=i.row;"row"==e.selMode&&(t="Z",o=e.curSelection.start.row),e.curSelection.tmp={col:t,row:o},e.curSelection.end=null,e.needsDraw=!0}e.listeners.hover&&e.listeners.hover(i.col,i.row,t.pageX,t.pageY)}(e,t)},up:function(t){var o;(o=e).attached&&(o.manipulatingVBar=!1,o.manipulatingHBar=!1,o.isSelecting&&(o.isSelecting=!1,o.curSelection.end=o.curSelection.tmp,o.needsDraw=!0,o.listeners.selection&&o.listeners.selection(o.curSelection.start,o.curSelection.end)))}}),e.canvas.addEventListener("contextmenu",(function(e){e.preventDefault(),e.stopPropagation()})),e.canvas.addEventListener("mousewheel",(function(t){const o=(new Date).getTime();if(o-e.lastMouseScroll<50)return;const n=t.deltaY/12,i=t.deltaX/12;let l=Math.floor(i),s=Math.floor(n);n>0&&(s=Math.ceil(n)),i>0&&(l=Math.ceil(i)),e.origin.col+=l,e.origin.row+=s,e.origin.row<e.minRow&&(e.origin.row=e.minRow),e.origin.row>e.totalRows&&(e.origin.row=e.totalRows),e.origin.col<e.minCol&&(e.origin.col=e.minCol),e.origin.col>e.totalColumns&&(e.origin.col=e.totalColumns),e.lastMouseScroll=o,e.needsDraw=!0}))}(o),new ResizeObserver(o.#e).observe(o.holder),new MutationObserver(o.#t).observe(o.holder,{attributes:!0,childList:!0,subtree:!0}),r[o.id]=o}dataChanged(){this.retainedValues={},this.needsDraw=!0}setColumnSizes(e){this.colSizes=e||{},this.needsDraw=!0}setRowSizes(e){this.rowSizes=e||{},this.needsDraw=!0}setSize(e,t){this.totalColumns=t,this.totalRows=e,this.needsDraw=!0}setMinRow(e){this.minRow=parseInt(e),isNaN(this.minRow)&&(this.minRow=0),this.origin.row<this.minRow&&(this.origin.row=this.minRow),this.needsDraw=!0}setMinCol(e){this.minCol=parseInt(e),isNaN(this.minCol)&&(this.minCol=0),this.origin.col<this.minCol&&(this.origin.col=this.minCol),this.needsDraw=!0}setSelection(e){e?(this.curSelection=e,this.curSelection.tmp||(this.curSelection.tmp=this.curSelection.start)):this.curSelection={start:null,end:null,tmp:null},this.needsDraw=!0}on(e,t){t?this.listeners[e]=t:delete this.listeners[e]}#e(){const e=this;e.resizePing&&clearTimeout(e.resizePing),e.resizePing=setTimeout(e.resize,40)}#o(){const e=this;e.resizePing&&clearTimeout(e.resizePing),e.resizePing=null}resize(){this.#o(),this.holder&&this.canvas&&this.attached&&function(e){let t=1;window.devicePixelRatio&&(t=window.devicePixelRatio);const o=e.holder.offsetWidth,n=e.holder.offsetHeight;e.height=Math.floor(n*t),e.width=Math.floor(o*t),e.canvas.width=e.width,e.canvas.height=e.height,e.scale=t,e.needsDraw=!0,e.listeners.resize&&e.listeners.resize()}(this)}#t(){this.holder&&this.canvas&&(document.body.contains(this.holder)&&this.holder.contains(this.canvas)||(this.attached=!1)),this.attached||(this.#o(),this.canvas.remove(),this.canvas=null,this.context=null,this.holder=null,delete r[this.id])}render(){this.needsDraw&&this.canvas&&this.context&&this.attached&&function(e){let t=.05;"default"!=e.selMode&&(t=.15);const o=function(e){let t;return 6==e.length||7==e.length?(t=/^#?([a-f\d]{2})([a-f\d]{2})([a-f\d]{2})$/i.exec(e),t?{a:255,r:parseInt(t[1],16),g:parseInt(t[2],16),b:parseInt(t[3],16)}:null):8==e.length||9==e.length?(t=/^#?([a-f\d]{2})([a-f\d]{2})([a-f\d]{2})([a-f\d]{2})$/i.exec(e),t?{a:parseInt(t[1],16),r:parseInt(t[2],16),g:parseInt(t[3],16),b:parseInt(t[4],16)}:null):{a:255,r:0,g:0,b:0}}(e.theme),n="rgba("+o.r+","+o.g+","+o.b+", "+t+")";let i="#000000";document.body.classList.contains("adlDark")&&(i="#ffffff"),e.canvas.width=e.width,e.canvas.height=e.height,e.context.clearRect(0,0,e.width,e.height);let l=null,s=null,r=0,a=0,h=0,u=0,d=0,f=0,p=0,x=0,v=-1,S=-1;if(e.curSelection&&e.curSelection.start&&e.curSelection.tmp&&(l=g(e,e.curSelection.start.col,e.curSelection.start.row),s=g(e,e.curSelection.tmp.col,e.curSelection.tmp.row),l.x>s.x?(r=s.x,h=l.x+l.width):(r=l.x,h=s.x+s.width),l.y>s.y?(a=s.y,u=l.y+l.height):(a=l.y,u=s.y+s.height),"row"==e.selMode&&(h=e.width*e.scale),d=h-r,f=u-a,e.context.fillStyle=n,e.context.fillRect(r,a,d,f)),e.context.fillStyle="rgba(130,130,130,0.075)",e.colHeaders&&e.context.fillRect(0,0,e.width,24*e.scale),e.rowHeaders&&e.context.fillRect(0,25,36*e.scale,e.height-24*e.scale),e.context.lineWidth=e.scale,e.context.strokeStyle="rgba(130,130,130,0.35)",e.colHeaders){const t=Math.floor(24*e.scale)+.5;e.context.beginPath(),e.context.moveTo(0,t),e.context.lineTo(e.width,t),e.context.stroke()}let y=0;if(e.rowHeaders){const t=Math.floor(36*e.scale)+.5;e.context.beginPath(),e.context.moveTo(t,0),e.context.lineTo(t,e.height),e.context.stroke(),y=37*e.scale}const b=c*e.scale,M=24*e.scale;e.context.font=12*e.scale+"px "+e.defFont,e.context.textAlign="center",e.context.fillStyle=i;let R=!0;const T=[];for(let t=e.origin.col;t<=e.totalColumns;t++){x++,-1==S&&(S=t);let o=b;const n=w(t);null!=e.colSizes[n]&&null!=e.colSizes[n]&&(o=parseInt(e.colSizes[n])*e.scale),e.context.font=12*e.scale+"px "+e.defFont,e.context.textAlign="center",e.context.fillStyle=i;const l=Math.floor(y+o)+.5;if(l>e.width+o)break;const s=Math.floor(l+o/2);e.colHeaders&&e.context.fillText(n,s-o,18*e.scale),e.gridlines&&(e.context.beginPath(),e.context.moveTo(l,0),e.context.lineTo(l,e.height),e.context.stroke()),y+=o;let c=0;e.colHeaders&&(c=25*e.scale);for(let l=e.origin.row;l<=e.totalRows;l++){R&&(p++,-1==v&&(v=l));let s=M;e.rowSizes[l]&&(s=parseInt(e.rowSizes[l])*e.scale);const r=Math.floor(c+s)+.5;if(r>e.height+s)break;const a=Math.floor(s/2);t==e.origin.col&&(e.context.font=12*e.scale+"px "+e.defFont,e.context.textAlign="center",e.context.fillStyle=i,e.rowHeaders&&e.context.fillText(l,18*e.scale,r-a+6*e.scale),e.gridlines&&(e.context.beginPath(),e.context.moveTo(0,r),e.context.lineTo(e.width,r),e.context.stroke())),e.listeners.cellValue&&T.push({col:n,row:l,x:y,y:c,width:o,height:s,cIdx:t}),c+=M,R=!1}}for(const t of T)m(e,t.col,t.row,t.x,t.y,t.width,t.height,i,t.cIdx);if(e.curSelection&&e.curSelection.start&&e.curSelection.tmp&&"default"==e.selMode){e.context.lineWidth=e.scale,e.context.strokeStyle=e.theme;const t=Math.floor(r)+.5,o=Math.floor(a)+.5,n=Math.floor(h)+.5,i=Math.floor(u)+.5;e.context.beginPath(),e.context.moveTo(t,o),e.context.lineTo(t,i),e.context.lineTo(n,i),e.context.lineTo(n,o),e.context.lineTo(t,o),e.context.stroke(),e.context.lineWidth=2*e.scale,e.context.beginPath(),e.context.moveTo(l.x,l.y),e.context.lineTo(l.x,l.y+l.height),e.context.lineTo(l.x+l.width,l.y+l.height),e.context.lineTo(l.x+l.width,l.y),e.context.lineTo(l.x,l.y),e.context.stroke()}e.vScrollShowing=!1,e.hScrollShowing=!1,function(e,t,o,n,i){if(t<e.totalRows){e.vScrollShowing=!0,e.context.fillStyle="rgba(130, 130, 130, 0.3)";const o=8*e.scale,i=e.width-o;e.context.fillRect(i,0,o,e.height);const l=t/e.totalRows;let s=Math.round(e.height*l);s<48*e.scale&&(s=48*e.scale);let c=n/(e.totalRows+t);c<0&&(c=0),c>100&&(c=100);const r=Math.round(e.height*c);e.context.fillStyle=e.theme,e.context.fillRect(i,r,o,s)}if(o<e.totalColumns){e.hScrollShowing=!0,e.context.fillStyle="rgba(130, 130, 130, 0.3)";const t=8*e.scale,n=e.height-t;let l=e.width;e.vScrollShowing&&(l-=8*e.scale),e.context.fillRect(0,n,l,t);const s=o/e.totalColumns;let c=Math.round(l*s);c<48*e.scale&&(c=48*e.scale);let r=i/(e.totalColumns+o);r<0&&(r=0),r>100&&(r=100);const a=Math.round(l*r);e.context.fillStyle=e.theme,e.context.fillRect(a,n,c,t)}}(e,p,x,v,S),e.needsDraw=!1}(this)}}function d(e,t){const o=t/e.height,n=Math.round(e.totalRows*o);e.origin.row=n,e.needsDraw=!0}function f(e,t){const o=t/e.width,n=Math.round(e.totalColumns*o);e.origin.col=n,e.needsDraw=!0}function p(e,t,o){t*=e.scale,o*=e.scale;const n={col:"-A",row:-1};let i=0;e.rowHeaders&&(i=37);let l=i*e.scale;const s=c*e.scale,r=24*e.scale;for(let i=e.origin.col;i<=e.totalColumns;i++){let c=s;const a=w(i);e.colSizes[a]&&(c=parseInt(e.colSizes[a])*e.scale);const h=Math.floor(l+c)+.5;if(h>e.width+c)break;t>l&&t<h&&(n.col=w(i));let u=0;e.colHeaders&&(u=25*e.scale);for(let t=e.origin.row;t<=e.totalRows;t++){let i=r;const l=Math.floor(u+i)+.5;if(l>e.height+i)break;o>u&&o<l&&(n.row=t),u+=i}l+=c}return n}function g(e,t,o){const n={x:0,y:0,width:0,height:0};let i=0;e.rowHeaders&&(i=37);let l=i*e.scale;const s=c*e.scale,r=24*e.scale;for(let i=e.origin.col;i<=e.totalColumns;i++){let c=s;const a=w(i);if(e.colSizes[a]&&(c=parseInt(e.colSizes[a])*e.scale),Math.floor(l+c)+.5>e.width+c)break;w(i)==t&&(n.x=l,n.width=c);let h=0;e.colHeaders&&(h=25*e.scale);for(let t=e.origin.row;t<=e.totalRows;t++){let i=r;if(Math.floor(h+i)+.5>e.height+i)break;t==o&&(n.y=h,n.height=i),h+=i}l+=c}return n}function w(e){const t="A,B,C,D,E,F,G,H,I,J,K,L,M,N,O,P,Q,R,S,T,U,V,W,X,Y,Z".split(",");return e<0?"-A":e>25?t[Math.floor(e/26)-1]+t[e%26]:t[e]}function m(e,t,o,n,i,l,s,r,u){const d=e.listeners.cellValue(e.tag,t,o);if(d){let t="left";d.f&&(d.f!=h.NUMBER&&d.f!=h.CURRENCY&&d.f!=h.PERCENT||(t="right"));let f=d.a||t,p=l,g=s,m=!1;if(d.cw&&d.cw>1){for(let t=u+1;t<u+d.cw;t++){const o=w(t),n=e.colSizes[o]||c;p+=Math.floor(n*e.scale)}m=!0}if(d.rh&&d.rh>1){for(let t=o+1;t<o+d.rh;t++){const o=e.rowSizes[t]||24;g+=Math.floor(o*e.scale)}m=!0}if(m&&e.context.clearRect(n+e.scale,i+e.scale,p-2*e.scale,g-2*e.scale),!d.bg||7!=d.bg.trim().length&&0!=d.bg.indexOf("rgb")||(e.context.fillStyle=d.bg,e.context.fillRect(n+e.scale,i+e.scale,p-2*e.scale,g-2*e.scale)),d.img){if(!a[d.img]){const t=new Image;t.onload=function(){e.needsDraw=!0},t.src=d.img,a[d.img]=t}const t=a[d.img];if(t.complete){const o=Math.floor(p-2*e.scale),l=Math.floor(g-2*e.scale);e.context.drawImage(t,n+e.scale,i+e.scale,o,l)}}if(d.v){let t=d.v,o=n;if(d.b&&1==d.b?e.context.font="bold "+12*e.scale+"px "+e.defFont:e.context.font=12*e.scale+"px "+e.defFont,d.c&&7==d.c.trim().length?e.context.fillStyle=d.c:e.context.fillStyle=r,e.context.textAlign=f,"right"==f&&(o+=p),"center"==f&&(o+=Math.floor(p/2)),d.f&&d.f==h.CURRENCY&&t&&(t=new Intl.NumberFormat(void 0,{style:"currency",currency:e.currencyCode}).format(t)),p>0){let n=e.context.measureText(t).width;for(;n>p;)t=t.toString().slice(0,-1),n=e.context.measureText(t).width;const l=Math.floor(i+g);e.context.textBaseline="bottom",e.context.fillText(t,o,l)}}}}!function e(){requestAnimationFrame(e);for(const e of Object.values(r))e.render()}();var x=t.v,v=t.k;export{x as ApeGrid,v as CELL_FORMATS};